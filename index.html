<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nh·∫≠t k√Ω nh·ªè cho ChouChou </title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#FFF8F2;
  --paper:#fffdf7;
  --accent:#ffd6e8;
  --text:#3b3b3b;
  --shadow: rgba(20,20,20,0.12);
}

*{box-sizing:border-box}
html,body{
  height:100%;
  margin:0;
  font-family:"Nunito", sans-serif;
  background: linear-gradient(180deg,#FFF9F5 0%,#FFF3EE 100%);
  color:var(--text);
  overflow:hidden;
}

/* INTRO */
.intro-screen{
  position:fixed;
  inset:0;
  background:var(--bg);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  z-index:900;
  transition:opacity 0.8s ease, transform 0.8s ease;
  text-align:center;
  padding:28px;
}
.intro-screen.hide{
  opacity:0;
  transform:translateY(-20px) scale(0.98);
  pointer-events:none;
}
.intro-title{
  font-size:28px;
  font-weight:700;
  color:var(--text);
  margin-bottom:8px;
}
.intro-sub{
  font-size:16px;
  color:#6b6b6b;
  margin-bottom:26px;
  white-space:pre-line;
}
.intro-btn{
  padding:10px 20px;
  border-radius:12px;
  background:var(--accent);
  border:none;
  cursor:pointer;
  font-weight:700;
  box-shadow:0 6px 16px rgba(0,0,0,0.12);
  transition:transform 0.25s ease;
}
.intro-btn:hover{transform:scale(1.05);}

/* APP */
.app-wrap{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:28px;
  opacity:0;
  transform:scale(0.96);
  transition:opacity 1s ease, transform 1s ease;
}
.app-wrap.show{
  opacity:1;
  transform:scale(1);
}

/* JOURNAL */
.journal-wrap{
  width:100%;
  max-width:1100px;
  display:flex;
  gap:36px;
  align-items:flex-start;
  justify-content:space-between;
  position:relative;
  padding:28px;
}
.stack{
  width:260px;
  height:340px;
  position:relative;
  transform:perspective(900px) rotateY(-10deg) rotateX(2deg);
  flex:0 0 260px;
}
.paper{
  width:100%;
  height:100%;
  position:absolute;
  left:0;
  top:0;
  background:var(--paper);
  border-radius:14px;
  box-shadow:0 24px 44px rgba(20,20,20,0.12);
  border:1px dashed rgba(150,130,130,0.35);
  background-image:radial-gradient(rgba(0,0,0,0.03) 1px, transparent 1px);
  background-size:6px 6px;
}
.paper:nth-child(1){transform:translate(0,0) rotate(-1.2deg);}
.paper:nth-child(2){transform:translate(10px,12px) rotate(0.9deg);}
.paper:nth-child(3){transform:translate(20px,24px) rotate(-0.5deg);}

.note-card{
  width:520px;
  height:340px;
  position:relative;
  flex:1 1 520px;
  display:flex;
  align-items:flex-start;
  justify-content:center;
}
.face{
  position:absolute;
  inset:0;
  border-radius:14px;
  background:var(--paper);
  border:1px dashed rgba(180,160,160,0.55);
  background-image:radial-gradient(rgba(0,0,0,0.03) 1px, transparent 1px);
  background-size:6px 6px;
  padding:28px;
  box-shadow:0 28px 48px rgba(12,12,12,0.12);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}

.note-title{font-weight:700;font-size:20px;margin-bottom:8px;}
.note-body{font-size:18px;line-height:1.6;text-align:center;margin:auto 0;cursor:pointer;}
.note-body::after{content:"(Nh·∫•n ƒë·ªÉ xem ti·∫øp)";display:block;font-size:12px;color:#888;margin-top:8px;}
#date{font-size:12px;color:#7a7a7a;margin-top:auto; text-align:right;}

/* FIX: ribbon che khu·∫•t */
.ribbon{
  position:absolute;
  top:-20px;
  left:14px;
  background:linear-gradient(45deg,#ffd6e8,#ffc3f5);
  padding:8px 14px;
  border-radius:12px;
  font-weight:700;
  font-size:13px;
  box-shadow:0 8px 18px rgba(0,0,0,0.08);
  z-index:10;
}

.controls{
  width:190px;
  display:flex;
  flex-direction:column;
  gap:14px;
  align-items:center;
}
.btn{
  width:100%;
  background:linear-gradient(180deg,#ffffff 0%,var(--accent) 100%);
  border:1px solid rgba(200,150,170,0.6);
  padding:12px 14px;
  border-radius:14px;
  cursor:pointer;
  box-shadow:0 10px 22px rgba(20,20,20,0.08);
  font-weight:700;
  font-size:14px;
  transition:transform 0.25s ease;
}
.btn:hover{transform:scale(1.04);}

/* ENDING: STAR SKY + MATRIX */
.end-scene{
  position:fixed;
  inset:0;
  background:black;
  overflow:hidden;
  z-index:999;
  display:none;
}
canvas#matrix{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  background:black;
}
.goodnight{
  position:absolute;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  color:#fff;
  font-size:32px;
  font-family:monospace;
  letter-spacing:2px;
  text-shadow:0 0 12px #fff;
  white-space:pre;
  z-index:1000;
  opacity:0;
  transition:opacity 2s ease;
}

/* stars */
.star{
  position:absolute;
  width:2px;
  height:2px;
  background:white;
  border-radius:50%;
  animation: twinkle 2s infinite ease-in-out;
}
@keyframes twinkle{
  0%,100%{opacity:0.2;}
  50%{opacity:1;}
}
</style>
</head>
<body>

<!-- INTRO -->
<div class="intro-screen" id="intro">
  <div class="intro-title">üê∞ G·ª≠i chouchou</div>
  <div class="intro-sub">M·ªói d√≤ng ch·ªØ l√† m·ªôt c√°i √¥m nh·ªè, g·ª≠i ƒë·∫øn ch·ªã b√©</div>
  <button class="intro-btn" id="openBtn">M·ªü nh·∫≠t k√Ω</button>
</div>

<!-- AUDIO -->
<audio id="bgm" src="song.mp3" loop></audio>

<!-- APP -->
<div class="app-wrap" id="app">
  <div class="journal-wrap">
    <div class="stack">
      <div class="paper"></div><div class="paper"></div><div class="paper"></div>
    </div>
    <div class="note-card">
      <div class="ribbon" id="ribbon">Vi·∫øt cho chouchou</div>
      <div class="face">
        <div class="note-title">Nh·∫≠t k√Ω nh·ªè</div>
        <div class="note-body" id="body">...</div>
        <div id="date"></div>
      </div>
    </div>
    <div class="controls">
      <button class="btn" id="newBtn">Xem l·∫°i t·ª´ ƒë·∫ßu</button>
    </div>
  </div>
</div>

<!-- END SCENE -->
<div class="end-scene" id="endScene">
  <canvas id="matrix"></canvas>
  <div class="goodnight" id="goodnight"></div>
</div>

<script>
const notes=[
  "Mong l√† nh·ªØng ƒëi·ªÅu nh·ªè nh·∫∑t n√†y ƒë·ªß ƒë·ªÉ mang l·∫°i cho ch·ªã m·ªôt ng√†y d·ªãu d√†ng h∆°n",
  "C√¥ng vi·ªác c√≥ th·ªÉ l√†m ch·ªã m·ªát m·ªèi nh∆∞ng ƒë√≥ v·ªën dƒ© l√† ph·∫ßn ch·ª© kh√¥ng ph·∫£i m·ªôt ƒë·ªùi",
  "Whatever Will Be, Will Be",
  "M·ªçi chuy·ªán r·ªìi s·∫Ω ·ªïn, n·∫øu kh√¥ng v√†o h√¥m nay th√¨ s·∫Ω l√† v√†o ng√†y n√†o ƒë√≥",
  "D√π th·∫ø gi·ªõi c√≥ ·ªìn √†o ƒë·∫øn ƒë√¢u, em mong ch·ªã v·∫´n gi·ªØ ƒë∆∞·ª£c g√≥c nh·ªè b√¨nh y√™n cho ri√™ng m√¨nh.",
  "M·∫∑t trƒÉng c≈©ng c√≥ l√∫c khuy·∫øt n√™n ch·ªã b√© c≈©ng ƒë∆∞·ª£c ph√©p ch∆∞a ho√†n h·∫£o",
  "C√≥ th·ªÉ ng√†y mai c≈©ng kh√¥ng kh√°c h√¥m nay nh∆∞ng bi·∫øt ƒë√¢u ch·ªã s·∫Ω c∆∞·ªùi nhi·ªÅu h∆°n 1 ch√∫t",
  "Em kh√¥ng th·ªÉ thay ƒë·ªïi ng√†y c·ªßa ch·ªã, nh∆∞ng hy v·ªçng c√¢u n√†y c√≥ th·ªÉ l√†m n√≥ ·∫•m h∆°n m·ªôt ch√∫t",
  "Em v·∫´n s·∫Ω ·ªü ƒë√¢y l·∫Øng nghe ch·ªã b√©."
];

const bodyEl=document.getElementById('body');
const dateEl=document.getElementById('date');
const bgm=document.getElementById('bgm');
const intro=document.getElementById('intro');
const app=document.getElementById('app');
const endScene=document.getElementById('endScene');
const goodnight=document.getElementById('goodnight');

function typeText(el,text,speed=45){
  return new Promise(resolve=>{
    el.textContent="";
    let i=0;
    const timer=setInterval(()=>{
      el.textContent=text.slice(0,i);
      i++;
      if(i>text.length){clearInterval(timer);resolve();}
    },speed);
  });
}

let idx=0;
let typing=false;
async function showNote(index){
  typing=true;
  const note=notes[index];
  dateEl.textContent=new Date().toLocaleDateString('vi-VN',{weekday:'short',day:'numeric',month:'short',year:'numeric'});
  await typeText(bodyEl,note,45);
  typing=false;
  if(index===notes.length-1){
    setTimeout(startEndScene,1200);
  }
}

bodyEl.addEventListener('click',()=>{
  if(typing)return;
  idx++;
  if(idx<notes.length) showNote(idx);
});

document.getElementById('newBtn').onclick=()=>{idx=0;showNote(idx);};

document.getElementById('openBtn').onclick=()=>{
  intro.classList.add('hide');
  setTimeout(()=>{
    intro.remove();
    app.classList.add('show');
    bgm.play().catch(()=>{});
    showNote(idx);
  },800);
};

/* END SCENE */
function startEndScene(){
  app.style.display="none";
  endScene.style.display="block";
  spawnStars(100);
  runMatrix();
  showGoodnight();
}

function showGoodnight(){
  typeText(goodnight,"Ch·ªã b√© ng·ªß ngon üí´",120).then(()=>{
    goodnight.style.opacity=1;
  });
}

function spawnStars(count){
  for(let i=0;i<count;i++){
    const s=document.createElement('div');
    s.className='star';
    s.style.left=Math.random()*100+'%';
    s.style.top=Math.random()*100+'%';
    s.style.animationDelay=Math.random()*2+'s';
    endScene.appendChild(s);
  }
}

function runMatrix(){
  const canvas=document.getElementById("matrix");
  const ctx=canvas.getContext("2d");
  canvas.width=window.innerWidth;
  canvas.height=window.innerHeight;
  const chars="01„Ç¢„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É©„ÉØ";
  const fontSize=16;
  const cols=canvas.width/fontSize;
  const drops=Array(Math.floor(cols)).fill(1);
  function draw(){
    ctx.fillStyle="rgba(0,0,0,0.05)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#ffb3ec";
    ctx.font=fontSize+"px monospace";
    for(let i=0;i<drops.length;i++){
      const text=chars.charAt(Math.floor(Math.random()*chars.length));
      ctx.fillText(text,i*fontSize,drops[i]*fontSize);
      if(drops[i]*fontSize>canvas.height && Math.random()>0.975){drops[i]=0;}
      drops[i]++;
    }
  }
  setInterval(draw,33);
}
</script>
</body>
</html>
