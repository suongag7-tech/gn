<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<title>Nh·∫≠t k√Ω nh·ªè cho ChouChou üíå</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;700&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#FFF8F2;
  --paper:#fffdf7;
  --accent:#ffd6e8;
  --text:#3b3b3b;
  --shadow: rgba(20,20,20,0.12);
}

*{box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{
  height:100%;
  margin:0;
  font-family:"Nunito",sans-serif;
  background:linear-gradient(180deg,#FFF9F5 0%,#FFF3EE 100%);
  color:var(--text);
  overflow-y:auto;
}

/* INTRO */
.intro-screen{
  position:fixed;
  inset:0;
  background:var(--bg);
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  z-index:900;
  transition:opacity .8s ease,transform .8s ease;
  text-align:center;
  padding:20px;
}
.intro-screen.hide{opacity:0;transform:translateY(-20px) scale(.98);pointer-events:none;}
.intro-title{font-size:clamp(22px,5vw,28px);font-weight:700;margin-bottom:8px;}
.intro-sub{font-size:clamp(14px,4vw,16px);color:#6b6b6b;margin-bottom:20px;white-space:pre-line;}
.intro-btn{
  padding:12px 24px;
  border-radius:12px;
  background:var(--accent);
  border:none;
  cursor:pointer;
  font-weight:700;
  box-shadow:0 6px 16px rgba(0,0,0,.12);
  transition:transform .25s ease;
}
.intro-btn:active{transform:scale(.95);}

/* APP */
.app-wrap{
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
  opacity:0;
  transform:scale(.96);
  transition:opacity 1s ease,transform 1s ease;
}
.app-wrap.show{opacity:1;transform:scale(1);}
.journal-wrap{
  width:100%;
  max-width:1100px;
  display:flex;
  flex-wrap:wrap;
  gap:20px;
  align-items:center;
  justify-content:center;
}
.stack{
  width:180px;
  height:240px;
  position:relative;
  transform:perspective(900px) rotateY(-8deg) rotateX(2deg);
  flex:0 0 180px;
}
.paper{
  width:100%;height:100%;
  position:absolute;left:0;top:0;
  background:var(--paper);
  border-radius:14px;
  box-shadow:0 12px 24px rgba(20,20,20,.12);
  border:1px dashed rgba(150,130,130,.35);
}
.paper:nth-child(1){transform:translate(0,0) rotate(-1.2deg);}
.paper:nth-child(2){transform:translate(6px,8px) rotate(0.9deg);}
.paper:nth-child(3){transform:translate(12px,16px) rotate(-0.5deg);}

/* NOTE */
.note-card{
  width:100%;
  max-width:520px;
  height:auto;
  min-height:300px;
  position:relative;
  display:flex;
  align-items:center;
  justify-content:center;
}
.face{
  width:100%;
  border-radius:14px;
  background:var(--paper);
  border:1px dashed rgba(180,160,160,.55);
  padding:20px;
  box-shadow:0 20px 32px rgba(12,12,12,.12);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
.note-title{font-weight:700;font-size:18px;margin-bottom:8px;text-align:center;}
.note-body{font-size:16px;line-height:1.6;text-align:center;margin:auto 0;cursor:pointer;word-break:break-word;}
.note-body::after{content:"(Nh·∫•n ƒë·ªÉ xem ti·∫øp)";display:block;font-size:12px;color:#888;margin-top:6px;}
#date{font-size:12px;color:#7a7a7a;margin-top:auto;text-align:right;}
.ribbon{
  position:absolute;
  top:-14px;left:10px;
  background:linear-gradient(45deg,#ffd6e8,#ffc3f5);
  padding:6px 10px;
  border-radius:10px;
  font-weight:700;
  font-size:12px;
  box-shadow:0 6px 12px rgba(0,0,0,.08);
  z-index:10;
}

/* CONTROLS */
.controls{
  width:180px;
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
}
.btn{
  width:100%;
  background:linear-gradient(180deg,#fff 0%,var(--accent) 100%);
  border:1px solid rgba(200,150,170,.6);
  padding:10px 12px;
  border-radius:14px;
  cursor:pointer;
  box-shadow:0 6px 16px rgba(20,20,20,.08);
  font-weight:700;
  font-size:14px;
  transition:transform .25s ease;
}
.btn:active{transform:scale(.96);}

/* END SCENE */
.end-scene{
  position:fixed;
  inset:0;
  background:black;
  overflow:hidden;
  z-index:999;
  display:none;
}
canvas#matrix{position:absolute;inset:0;width:100%;height:100%;background:black;}
.goodnight{
  position:absolute;top:50%;left:50%;
  transform:translate(-50%,-50%);
  color:#fff;font-size:clamp(22px,6vw,32px);
  font-family:monospace;
  text-shadow:0 0 12px #fff;
  white-space:pre;
  opacity:0;
  transition:opacity 2s ease;
}
.star{
  position:absolute;width:2px;height:2px;
  background:white;border-radius:50%;
  animation:twinkle 2s infinite ease-in-out;
}
@keyframes twinkle{0%,100%{opacity:.2;}50%{opacity:1;}}
</style>
</head>
<body>

<!-- INTRO -->
<div class="intro-screen" id="intro">
  <div class="intro-title">üê∞ G·ª≠i ChouChou</div>
  <div class="intro-sub">M·ªói d√≤ng ch·ªØ l√† m·ªôt c√°i √¥m nh·ªè, g·ª≠i ƒë·∫øn ch·ªã b√©</div>
  <button class="intro-btn" id="openBtn">M·ªü nh·∫≠t k√Ω</button>
</div>

<!-- AUDIO -->
<audio id="bgm" src="song.mp3" preload="auto" loop></audio>

<!-- APP -->
<div class="app-wrap" id="app">
  <div class="journal-wrap">
    <div class="stack">
      <div class="paper"></div><div class="paper"></div><div class="paper"></div>
    </div>
    <div class="note-card">
      <div class="ribbon" id="ribbon">Vi·∫øt cho ChouChou</div>
      <div class="face">
        <div class="note-title">Nh·∫≠t k√Ω nh·ªè</div>
        <div class="note-body" id="body">...</div>
        <div id="date"></div>
      </div>
    </div>
    <div class="controls">
      <button class="btn" id="newBtn">Xem l·∫°i t·ª´ ƒë·∫ßu</button>
    </div>
  </div>
</div>

<!-- END SCENE -->
<div class="end-scene" id="endScene">
  <canvas id="matrix"></canvas>
  <div class="goodnight" id="goodnight"></div>
</div>

<script>
const notes=[
  "Mong l√† nh·ªØng ƒëi·ªÅu nh·ªè nh·∫∑t n√†y ƒë·ªß ƒë·ªÉ mang l·∫°i cho ch·ªã m·ªôt ng√†y d·ªãu d√†ng h∆°n",
  "C√¥ng vi·ªác c√≥ th·ªÉ l√†m ch·ªã m·ªát m·ªèi nh∆∞ng ƒë√≥ v·ªën dƒ© l√† m·ªôt ph·∫ßn ch·ª© kh√¥ng ph·∫£i m·ªôt ƒë·ªùi",
  "Whatever Will Be, Will Be",
  "M·ªçi chuy·ªán r·ªìi s·∫Ω ·ªïn, n·∫øu kh√¥ng v√†o h√¥m nay th√¨ s·∫Ω l√† v√†o ng√†y n√†o ƒë√≥",
  "D√π th·∫ø gi·ªõi c√≥ ·ªìn √†o ƒë·∫øn ƒë√¢u, em mong ch·ªã v·∫´n gi·ªØ ƒë∆∞·ª£c g√≥c nh·ªè b√¨nh y√™n cho ri√™ng m√¨nh.",
  "M·∫∑t trƒÉng c≈©ng c√≥ l√∫c khuy·∫øt n√™n ch·ªã b√© c≈©ng ƒë∆∞·ª£c ph√©p ch∆∞a ho√†n h·∫£o",
  "C√≥ th·ªÉ ng√†y mai c≈©ng kh√¥ng kh√°c h√¥m nay nh∆∞ng bi·∫øt ƒë√¢u ch·ªã s·∫Ω c∆∞·ªùi nhi·ªÅu h∆°n 1 ch√∫t",
  "Em kh√¥ng th·ªÉ thay ƒë·ªïi ng√†y c·ªßa ch·ªã, nh∆∞ng hy v·ªçng c√¢u n√†y c√≥ th·ªÉ l√†m n√≥ ·∫•m h∆°n m·ªôt ch√∫t",
  "Em v·∫´n s·∫Ω ·ªü ƒë√¢y l·∫Øng nghe ch·ªã b√©."
];

const bodyEl=document.getElementById('body');
const dateEl=document.getElementById('date');
const bgm=document.getElementById('bgm');
const intro=document.getElementById('intro');
const app=document.getElementById('app');
const endScene=document.getElementById('endScene');
const goodnight=document.getElementById('goodnight');

function typeText(el,text,speed=45){
  return new Promise(resolve=>{
    el.textContent="";
    let i=0;
    const timer=setInterval(()=>{
      el.textContent=text.slice(0,i);
      i++;
      if(i>text.length){clearInterval(timer);resolve();}
    },speed);
  });
}

let idx=0,typing=false;
async function showNote(index){
  typing=true;
  const note=notes[index];
  dateEl.textContent=new Date().toLocaleDateString('vi-VN',{weekday:'short',day:'numeric',month:'short',year:'numeric'});
  await typeText(bodyEl,note,45);
  typing=false;
  if(index===notes.length-1){
    setTimeout(startEndScene,1500);
  }
}

bodyEl.addEventListener('click',()=>{
  if(typing)return;
  idx++;
  if(idx<notes.length) showNote(idx);
});

document.getElementById('newBtn').onclick=()=>{idx=0;showNote(idx);};

document.getElementById('openBtn').onclick=()=>{
  intro.classList.add('hide');
  setTimeout(()=>{
    intro.remove();
    app.classList.add('show');
    bgm.play().catch(()=>{}); // B·∫Øt bu·ªôc thao t√°c ng∆∞·ªùi d√πng tr√™n mobile
    showNote(idx);
  },800);
};

/* END SCENE */
function startEndScene(){
  app.style.display="none";
  endScene.style.display="block";
  spawnStars(80);
  runMatrix();
  showGoodnight();
}

function showGoodnight(){
  typeText(goodnight,"Ch·ªã b√© ng·ªß ngon üí´",120).then(()=>goodnight.style.opacity=1);
}

function spawnStars(count){
  for(let i=0;i<count;i++){
    const s=document.createElement('div');
    s.className='star';
    s.style.left=Math.random()*100+'%';
    s.style.top=Math.random()*100+'%';
    s.style.animationDelay=Math.random()*2+'s';
    endScene.appendChild(s);
  }
}

function runMatrix(){
  const canvas=document.getElementById("matrix");
  const ctx=canvas.getContext("2d");
  const resize=()=>{
    canvas.width=window.innerWidth;
    canvas.height=window.innerHeight;
  };
  resize();
  window.addEventListener('resize',resize);
  const chars="01„Ç¢„Ç´„Çµ„Çø„Éä„Éè„Éû„É§„É©„ÉØ";
  const fontSize=16;
  let cols=Math.floor(canvas.width/fontSize);
  const drops=Array(cols).fill(1);
  function draw(){
    ctx.fillStyle="rgba(0,0,0,0.05)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#ffb3ec";
    ctx.font=fontSize+"px monospace";
    for(let i=0;i<drops.length;i++){
      const text=chars.charAt(Math.floor(Math.random()*chars.length));
      ctx.fillText(text,i*fontSize,drops[i]*fontSize);
      if(drops[i]*fontSize>canvas.height && Math.random()>0.975){drops[i]=0;}
      drops[i]++;
    }
  }
  setInterval(draw,40);
}
</script>
</body>
</html>

